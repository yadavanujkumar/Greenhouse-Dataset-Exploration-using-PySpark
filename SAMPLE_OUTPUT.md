# Sample Output Documentation

This document shows examples of the analysis outputs generated by the PySpark data engineering project.

## Generated Files

When you run `python main.py`, the following CSV files are generated in the `output/analysis/` directory:

### 1. Top Emitters Analysis
**File:** `output/analysis/top_emitters/`

Top 20 industries with the highest greenhouse gas emissions.

```csv
NAICS_Code,Industry,Total_Emissions
327310,Cement Manufacturing,3.924
112111,Beef Cattle Ranching and Farming,2.893
112112,Cattle Feedlots,2.893
112130,Dual-Purpose Cattle Ranching and Farming,2.893
112120,Dairy Cattle and Milk Production,1.724
327410,Lime Manufacturing,1.623
327420,Gypsum Product Manufacturing,1.623
486990,All Other Pipeline Transportation,1.619
```

### 2. Sector Analysis
**File:** `output/analysis/sector_analysis/`

Aggregated emissions by industry sector (2-digit NAICS code).

```csv
Sector_Code,Industry_Count,Avg_Emissions,Total_Emissions,Avg_Emissions_Rounded
32,97,0.5313298969072168,51.53900000000002,0.531
11,64,0.7266250000000002,46.50400000000001,0.727
33,189,0.23153439153439154,43.76,0.232
31,73,0.4200958904109591,30.667000000000016,0.42
48,50,0.5582399999999997,27.911999999999985,0.558
```

### 3. Margin Impact Analysis
**File:** `output/analysis/margin_impact/`

Shows how trade margins affect emission factors.

```csv
NAICS_Code,Industry,Without_Margins,Margins,With_Margins,Margin_Percentage
333112,Lawn and Garden Tractor Manufacturing,0.052,0.068,0.12,130.77
511210,Software Publishers,0.036,0.045,0.08,125.0
335912,Primary Battery Manufacturing,0.046,0.057,0.103,123.91
```

### 4. High Emission Industries
**File:** `output/analysis/high_emission_industries/`

Industries exceeding the emission threshold (default: 1.0 kg CO2e/USD).

```csv
NAICS_Code,Industry,Emissions,Unit
327310,Cement Manufacturing,3.924,kg CO2e/2022 USD, purchaser price
112111,Beef Cattle Ranching and Farming,2.893,kg CO2e/2022 USD, purchaser price
112112,Cattle Feedlots,2.893,kg CO2e/2022 USD, purchaser price
```

### 5. Emission Distribution
**File:** `output/analysis/emission_distribution/`

Distribution of industries across emission ranges.

```csv
Emission_Range,Industry_Count
High (2.0-5.0),20
Low (0.5-1.0),134
Medium (1.0-2.0),62
Very High (>= 5.0),0
Very Low (< 0.5),800
```

### 6. GHG Type Analysis
**File:** `output/analysis/ghg_type_analysis/`

Breakdown of emissions by individual greenhouse gas types.

```csv
GHG,Record_Count,Total_Emissions,Avg_Emissions,Avg_Emissions_Rounded
Carbon dioxide,1016,198.0445999999997,0.19492578740157449,0.194926
HFCs and PFCs unspecified,1016,2.0330730000000035,0.0020010561023622083,0.002001
Methane,1016,1.6964329000000005,0.001669717421259843,0.00167
Nitrous oxide,1016,0.1343224199999999,1.3220710629921248E-4,1.32E-4
```

## Console Output Summary

The application also provides a comprehensive console output with:

- Data loading progress
- Data quality reports
- Statistical summaries
- Analysis results displayed in formatted tables
- Overall statistics (total emissions, industry count, etc.)

### Sample Statistics Output:

```
Overall Emission Statistics:
  Total Industries Analyzed: 1,016
  Total Emissions: 286.41 kg CO2e/2022 USD
  Average Emissions: 0.2819 kg CO2e/2022 USD

ANALYSIS SUMMARY
✓ Processed 1,016 CO2e emission records
✓ Processed 18,288 individual GHG records
✓ Analyzed 1,016 industries
✓ Identified 36 high-emission industries
✓ Generated 6 analysis reports
```

## Using the Results

The generated CSV files can be:
- Imported into Excel or other spreadsheet software for further analysis
- Visualized using Python libraries (matplotlib, seaborn, plotly)
- Integrated into dashboards (Tableau, Power BI)
- Used as input for machine learning models
- Shared with stakeholders for decision-making

## Customization

You can customize the analysis by modifying `config/config.py`:

```python
analysis_params = {
    'top_n_emitters': 20,        # Change number of top emitters
    'emission_threshold': 1.0     # Change threshold for high emitters
}
```
